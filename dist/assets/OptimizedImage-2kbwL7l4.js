import{r as s,j as a}from"./ui-vendor-Odbjkxui.js";import{L as E}from"./index-ymoYtU3-.js";const L=s.memo(({src:x,alt:c,className:z="",width:t,height:C,priority:S=!1,placeholder:n="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjM2I0MjU5Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iI2ZmZiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkxvYWRpbmcuLi48L3RleHQ+PC9zdmc+"})=>{const[I,l]=s.useState(!0),[b,u]=s.useState(!1),[p,g]=s.useState(n),[w,y]=s.useState(0),Z=s.useRef(null),j=e=>{const o=["#3B82F6","#8B5CF6","#EC4899","#10B981","#F59E0B","#EF4444"],r=o[e.length%o.length],m=e.split(" ").map(i=>i[0]).join("").toUpperCase().slice(0,2);return`data:image/svg+xml;base64,${btoa(`
      <svg width="200" height="200" xmlns="http://www.w3.org/2000/svg">
        <rect width="100%" height="100%" fill="${r}"/>
        <text x="50%" y="50%" font-family="Arial, sans-serif" font-size="48" fill="white" text-anchor="middle" dy=".3em">${m}</text>
      </svg>
    `)}`},v=s.useCallback(e=>{if(!e||e===n)return n;if(e.includes("image.tmdb.org")){const o=t&&t<=100?"w150":t&&t<=200?"w300":t&&t<=400?"w500":"w780";return e.replace("/t/p/w500/",`/t/p/${o}/`)}return e},[n,t]),f=s.useCallback((e,o=!1)=>{if(!e||e===n)return;l(!0),u(!1);const r=v(e),m=performance.now(),i=new Image;return i.onload=()=>{performance.now()-m,g(r),l(!1),y(0)},i.onerror=()=>{if(performance.now()-m,r.includes("image.tmdb.org")&&w<2&&!o){y(R=>R+1);const d=["w92","w154","w185","w342","w500","w780","original"],h=r.match(/\/t\/p\/([^/]+)\//)?.[1],N=d.indexOf(h||"w500"),M=d[Math.min(N+1,d.length-1)],B=r.replace(/\/t\/p\/[^/]+\//,`/t/p/${M}/`);requestAnimationFrame(()=>f(B,!0));return}u(!0),l(!1),g(j(c))},i.src=r,()=>{i.onload=null,i.onerror=null}},[n,w,c,v]);return s.useEffect(()=>{f(x)},[x,t,n,f]),a.jsxs("div",{className:`relative overflow-hidden ${z}`,style:{contentVisibility:"auto"},children:[a.jsx("img",{ref:Z,src:p,alt:c,width:t,height:C,loading:S?"eager":"lazy",decoding:"async",draggable:!1,className:`transition-all duration-300 ${I?"blur-sm scale-105":"blur-0 scale-100"} ${b?"opacity-90":"opacity-100"}`,onLoad:()=>l(!1),onError:()=>{u(!0),l(!1),g(j(c))}}),I&&a.jsx("div",{className:"absolute inset-0 bg-gray-800/20 flex items-center justify-center",children:a.jsx(E,{variant:"entertainment",size:"sm",text:""})}),b&&p===n&&a.jsx("div",{className:"absolute inset-0 bg-gray-800/50 flex items-center justify-center",children:a.jsx("div",{className:"text-white text-xs text-center",children:a.jsx("div",{className:"w-8 h-8 mx-auto mb-1 bg-gray-600 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-gray-400",children:"!"})})})})]})});L.displayName="OptimizedImage";export{L as O};
