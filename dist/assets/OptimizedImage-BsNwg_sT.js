import{r as s,j as n}from"./ui-vendor-DQZCqp4T.js";import{L as R}from"./index-C4SVGwdF.js";const E=s.memo(({src:f,alt:m,className:v="",width:t,height:z,priority:C=!1,placeholder:a="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjM2I0MjU5Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iI2ZmZiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkxvYWRpbmcuLi48L3RleHQ+PC9zdmc+"})=>{const[x,o]=s.useState(!0),[I,u]=s.useState(!1),[b,g]=s.useState(a),[p,y]=s.useState(0),S=s.useRef(null),j=e=>{const l=["#3B82F6","#8B5CF6","#EC4899","#10B981","#F59E0B","#EF4444"],r=l[e.length%l.length],i=e.split(" ").map(c=>c[0]).join("").toUpperCase().slice(0,2);return`data:image/svg+xml;base64,${btoa(`
      <svg width="200" height="200" xmlns="http://www.w3.org/2000/svg">
        <rect width="100%" height="100%" fill="${r}"/>
        <text x="50%" y="50%" font-family="Arial, sans-serif" font-size="48" fill="white" text-anchor="middle" dy=".3em">${i}</text>
      </svg>
    `)}`},w=s.useCallback(e=>{if(!e||e===a)return a;if(e.includes("image.tmdb.org")){const l=t&&t<=100?"w150":t&&t<=200?"w300":t&&t<=400?"w500":"w780";return e.replace("/t/p/w500/",`/t/p/${l}/`)}return e},[a,t]),d=s.useCallback((e,l=!1)=>{if(!e||e===a)return;o(!0),u(!1);const r=w(e),i=new Image;return i.onload=()=>{g(r),o(!1),y(0)},i.onerror=()=>{if(r.includes("image.tmdb.org")&&p<2&&!l){y(B=>B+1);const c=["w92","w154","w185","w342","w500","w780","original"],Z=r.match(/\/t\/p\/([^/]+)\//)?.[1],h=c.indexOf(Z||"w500"),N=c[Math.min(h+1,c.length-1)],M=r.replace(/\/t\/p\/[^/]+\//,`/t/p/${N}/`);requestAnimationFrame(()=>d(M,!0));return}u(!0),o(!1),g(j(m))},i.src=r,()=>{i.onload=null,i.onerror=null}},[a,p,m,w]);return s.useEffect(()=>{d(f)},[f,t,a,d]),n.jsxs("div",{className:`relative overflow-hidden ${v}`,style:{contentVisibility:"auto"},children:[n.jsx("img",{ref:S,src:b,alt:m,width:t,height:z,loading:C?"eager":"lazy",decoding:"async",draggable:!1,className:`transition-all duration-300 ${x?"blur-sm scale-105":"blur-0 scale-100"} ${I?"opacity-90":"opacity-100"}`,onLoad:()=>o(!1),onError:()=>{u(!0),o(!1),g(j(m))}}),x&&n.jsx("div",{className:"absolute inset-0 bg-gray-800/20 flex items-center justify-center",children:n.jsx(R,{variant:"entertainment",size:"sm",text:""})}),I&&b===a&&n.jsx("div",{className:"absolute inset-0 bg-gray-800/50 flex items-center justify-center",children:n.jsx("div",{className:"text-white text-xs text-center",children:n.jsx("div",{className:"w-8 h-8 mx-auto mb-1 bg-gray-600 rounded-full flex items-center justify-center",children:n.jsx("span",{className:"text-gray-400",children:"!"})})})})]})});E.displayName="OptimizedImage";export{E as O};
